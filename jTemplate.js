!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}i.m=t,i.c=e,i.p="",i(0)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(1);e.Template=n.Template;const r=i(8);e.ObjectStore=r.ObjectStore,e.Value=r.Value;const s=i(13);e.div=s.div,e.span=s.span,e.input=s.input,e.b=s.b,e.a=s.a,e.br=s.br,e.img=s.img,e.video=s.video,e.source=s.source,e.option=s.option,e.select=s.select,e.h1=s.h1,e.h2=s.h2,e.h3=s.h3},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(2),r=i(5),s=i(10),a=i(11),o=i(12);function h(t,e,i,n){return{type:t,class:e,props:i&&i.props,on:i&&i.on,data:i&&i.data,key:i&&i.key,templates:n}}function u(){return!0}e.TemplateFunction=function(t,e,i){return{type:t,props:e&&e.props,on:e&&e.on,data:e&&e.data,key:e&&e.key,text:e&&e.text,children:i}};class l{constructor(t){"string"==typeof t&&(t=h(t,this.constructor)),this.templates=this.DefaultTemplates,this.SetTemplates(t.templates),t.children=t.children||this.Template.bind(this),this.bindingDefinition=t}get DefaultTemplates(){return{}}get Templates(){return this.templates}get Root(){return this.bindingRoot}SetTemplates(t){if(t)for(var e in t)this.templates[e]=t[e]}UpdateComplete(t){n.BindingConfig.updateComplete(t)}AttachTo(t){this.bindingRoot||this.BindRoot(),n.BindingConfig.addChild(t,this.bindingRoot)}AttachToContainer(t){this.bindingRoot||this.BindRoot(),n.BindingConfig.addContainerChild(t,this.bindingRoot)}AttachBefore(t,e){this.bindingRoot||this.BindRoot(),n.BindingConfig.addChildBefore(t,e&&e.bindingRoot,this.bindingRoot)}AttachAfter(t,e){this.bindingRoot||this.BindRoot(),n.BindingConfig.addChildAfter(t,e&&e.bindingRoot,this.bindingRoot)}Detach(){n.BindingConfig.remove(this.bindingRoot)}Destroy(){this.Detach(),this.bindingRoot=null,this.bindings.forEach(t=>t.Destroy()),this.bindings=[]}Template(t,e){return[]}BindRoot(){var t,e,i,h;this.bindingRoot=n.BindingConfig.createBindingTarget(this.bindingDefinition.type),this.bindings=(t=this.bindingRoot,e=this.bindingDefinition,i=[],(h=e).props&&i.push(new r.default(t,h.props)),h.on&&i.push(new o.default(t,h.on)),h.text?i.push(new a.default(t,h.text)):h.children&&(h.data=h.data||u,i.push(new s.default(t,h.data,h.children,h.key))),i)}}e.Template=l,function(t){t.ToFunction=function(t,e){return function(t,e){return h.bind(null,t,e)}(t,e)}}(l=e.Template||(e.Template={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3);e.BindingConfig=n.DOMBindingConfig},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(4);var r=[],s=!1,a=0,o=3e3;function h(){for(var t=o+a,e=a;e<t&&e<r.length;e++,a++)r[e]();a==r.length?(a=0,r=[],s=!1):n.browser.requestAnimationFrame(h)}e.DOMBindingConfig={scheduleUpdate:function(t){r.push(t),s||(s=!0,n.browser.requestAnimationFrame(h))},updateComplete:function(t){0!==r.length?(r.push(t),s||(s=!0,n.browser.requestAnimationFrame(h))):t()},addListener:function(t,e,i){t.addEventListener(e,i)},removeListener:function(t,e,i){t.removeEventListener(e,i)},createBindingTarget:function(t){return n.browser.window.document.createElement(t)},addChild:function(t,e){t.appendChild(e)},addChildFirst:function(t,i){e.DOMBindingConfig.addChildBefore(t,t.firstChild,i)},addChildBefore:function(t,i,n){i?t.insertBefore(n,i):e.DOMBindingConfig.addChild(t,n)},addChildAfter:function(t,i,n){i?e.DOMBindingConfig.addChildBefore(t,i.nextSibling,n):e.DOMBindingConfig.addChildFirst(t,n)},removeChild:function(t,e){t.removeChild(e)},remove:function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},setText:function(t,e){t.textContent=e},createContainer:()=>n.browser.createDocumentFragment(),addContainerChild(t,e){t.appendChild(e)},addChildContainer(t,e){t.appendChild(e)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=null;function r(t){return t(),0}n="undefined"!=typeof window?window:new(i(!function(){var t=new Error('Cannot find module "jsdom"');throw t.code="MODULE_NOT_FOUND",t}()).JSDOM)("").window;var s=!1,a=/<([^\s]+)([^>]*)\/>/g;e.browser={window:n,get immediateAnimationFrames(){return s},set immediateAnimationFrames(t){s=t,this.requestAnimationFrame=(s?r:n.requestAnimationFrame||r).bind(n)},requestAnimationFrame:null,createDocumentFragment:function t(e){if("string"==typeof e)return e=e.replace(a,function(t,e,i){return`<${e}${i}></${e}>`}),t((new n.DOMParser).parseFromString(e,"text/html").body);for(var i=n.document.createDocumentFragment();e&&e.childNodes.length>0;)i.appendChild(e.childNodes[0]);return i}},e.browser.immediateAnimationFrames=!1},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(6);e.default=class extends n.Binding{constructor(t,e){super(t,e,null)}Apply(){this.lastValue=this.lastValue||{},this.ApplyRecursive(this.BoundTo,this.lastValue,this.Value),this.lastValue=this.Value}ApplyRecursive(t,e,i){if("object"!=typeof i)throw"Property binding must resolve to an object";for(var n in i){var r=i[n];t[n]&&null!==r&&"object"==typeof r&&r.constructor==={}.constructor?(e[n]=e[n]||{},this.ApplyRecursive(t[n],e[n],r)):(r=r&&r.valueOf(),e[n]!==r&&(t[n]=r))}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(7),r=i(2);var s;!function(t){t[t.Init=0]="Init",t[t.Updating=1]="Updating",t[t.Updated=2]="Updated",t[t.Destroyed=3]="Destroyed"}(s||(s={}));e.Binding=class{constructor(t,e,i){this.boundTo=t,this.status=s.Init,this.setCallback=this.Update.bind(this),this.observableScope=new n.ObjectStoreScope(e),this.observableScope.addListener("set",this.setCallback),this.Init(i),this.Update()}get Value(){return this.observableScope.Value}get BoundTo(){return this.boundTo}Update(){this.status!==s.Destroyed&&(this.status===s.Init?(this.status=s.Updating,this.Apply(),this.status=s.Updated):this.status!==s.Updating&&(this.status=s.Updating,r.BindingConfig.scheduleUpdate(()=>{this.status!==s.Destroyed&&(this.Apply(),this.status=s.Updated)})))}Destroy(){this.observableScope&&this.observableScope.Destroy(),this.status=s.Destroyed}Init(t){}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(8),r=i(9);e.ObjectStoreScope=class extends r.Emitter{constructor(t){super(),this.valueFunction=t,this.trackedEmitters=new Set,this.setCallback=this.SetCallback.bind(this),this.UpdateValue()}get Value(){return this.dirty?(this.UpdateValue(),this.value):this.value}Destroy(){this.removeAllListeners(),this.trackedEmitters.forEach(t=>t.removeListener("set",this.setCallback)),this.trackedEmitters.clear()}UpdateValue(){var t=n.ObjectStore.Watch(()=>{try{this.value=this.valueFunction()}catch(t){console.error(t)}}),e=new Set(t);this.trackedEmitters.forEach(t=>{e.has(t)||t.removeListener("set",this.setCallback)}),e.forEach(t=>t.addListener("set",this.setCallback)),this.trackedEmitters=e,this.dirty=!1}SetCallback(){this.dirty=!0,this.emit("set")}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(9);function r(t){return!t||!(Array.isArray(t)||"object"==typeof t&&{}.constructor===t.constructor)}var s=new n.default;class a extends n.default{constructor(t,e){super(),this.___path=t,this.store=e}}class o{constructor(){}get Value(){return this.getValue()}set Value(t){this.setValue(t)}toString(){var t=this.Value;return t&&t.toString()}valueOf(){var t=this.Value;return t&&t.valueOf()}}e.Value=o;class h extends o{constructor(t,e){super(),this.store=t,this.valuePath=e}getValue(){var t=this.store.GetEmitter(this.valuePath);return s.emit("get",t),this.store.GetPath(this.valuePath)}setValue(t){this.store.SetPath(this.valuePath,t),this.store.GetEmitter(this.valuePath).emit("set")}}class u extends o{constructor(t){super(),this.value=t,this.emitter=new n.default}getValue(){return s.emit("get",this.emitter),this.value}setValue(t){this.value=t,this.emitter.emit("set")}}class l{constructor(t){this.getIdCallback=t,this.emitterMap=new Map,this.emitterMap.set("root",new a("root",this)),this.getterMap=new Map,this.idToPathsMap=new Map}get Root(){return this.EmitGet("root"),this.getterMap.get("root")||this.CreateGetterObject(this.root,"root")}set Root(t){this.Write(null,()=>t)}Get(t){var e=this.idToPathsMap.get(t);if(!e)return null;var i=e.values().next().value;return this.EmitGet(i),this.getterMap.get(i)||this.CreateGetterObject(this.ResolvePropertyPath(i),i)}GetPath(t){var e=this.ResolvePropertyPath(t);return this.EmitGet(t),e}SetPath(t,e){this.WriteTo(t,e)}GetEmitter(t){return this.emitterMap.get(t)}Write(t,e){if("string"!=typeof t||(t=this.Get(t))){var i=t?t.___path:"root",n=this.ResolvePropertyPath(i),r=null,s=null;r="function"==typeof e?e(s=this.CreateCopy(n)):e,this.WriteTo(i,void 0!==r?r:s)}}Push(t,e){var i=t.___path,n=this.ResolvePropertyPath(i),r=[i,n.length].join(".");n.push(null),this.WriteTo(r,e),this.getterMap.get(i).push(this.CreateGetterObject(e,r)),this.EmitSet(i)}WriteTo(t,e,i){var n=this.ResolvePropertyPath(t);n!==e&&(this.AssignPropertyPath(e,t),this.ProcessChanges(t,t,e,n,i))}ProcessChanges(t,e,i,n,s){this.getterMap.delete(e);var a=i&&this.getIdCallback&&this.getIdCallback(i),o=n&&this.getIdCallback&&this.getIdCallback(n);if(o&&o!==a){var h=this.idToPathsMap.get(o);h.delete(e),0===h.size&&this.idToPathsMap.delete(o)}if(!s&&a){var u=this.idToPathsMap.get(a);u?u.has(e)||u.add(e):(u=new Set([e]),this.idToPathsMap.set(a,u)),u.forEach(n=>{n!==e&&0!==n.indexOf(t)&&this.WriteTo(n,i,!0)})}var l=new Set;if(!r(i))for(var c in i){var d=[e,c].join(".");this.ProcessChanges(t,d,i[c],n&&n[c],s),l.add(c)}this.CleanUp(n,l,e),this.EmitSet(e)}CleanUp(t,e,i){if(!r(t)){for(var n in t)if(!e||!e.has(n)){var s=[i,n].join(".");this.emitterMap.delete(s),this.getterMap.delete(s),this.CleanUp(t[n],null,s)}if(!e||0===e.size){var a=this.getIdCallback&&this.getIdCallback(t);if(a){var o=this.idToPathsMap.get(a);o&&(o.delete(i),0===o.size&&this.idToPathsMap.delete(a))}}}}AssignPropertyPath(t,e){var i=e.split("."),n=i[i.length-1],r=i.slice(0,i.length-1);this.ResolvePropertyPath(r.join("."))[n]=t}ResolvePropertyPath(t){return t?t.split(".").reduce((t,e)=>t&&t[e],this):this}CreateGetterObject(t,e){if(r(t))return t;var i=null;if(Array.isArray(t)){i=new Array(t.length);for(var n=0;n<t.length;n++)i[n]=this.CreateGetterObject(t[n],[e,n].join("."))}else for(var s in i=Object.create(null),t)this.CreateGetter(i,e,s);return Object.defineProperty(i,"___path",{value:e,configurable:!1,enumerable:!1,writable:!1}),this.getterMap.set(e,i),i}CreateGetter(t,e,i){var n=[e,i].join(".");Object.defineProperty(t,i,{enumerable:!0,get:()=>{return this.EmitGet(n),this.getterMap.get(n)||this.CreateGetterObject(this.ResolvePropertyPath(n),n)},set:t=>{this.WriteTo(n,t)}})}CreateCopy(t){if(r(t))return t;var e=null;if(Array.isArray(t)){e=new Array(t.length);for(var i=0;i<t.length;i++)e[i]=this.CreateCopy(t[i]);return e}for(var n in e={},t)e[n]=this.CreateCopy(t[n]);return e}EmitSet(t){var e=this.emitterMap.get(t);e||(e=new a(t,this),this.emitterMap.set(t,e)),e.emit("set")}EmitGet(t){var e=this.emitterMap.get(t);e||(e=new a(t,this),this.emitterMap.set(t,e)),s.emit("get",e)}}e.ObjectStore=l,function(t){t.Create=function(e,i){if(r(e))throw"Only arrays and JSON types are supported";var n=new t(i);return n.Root=e,n},t.Watch=function(t){var e=new Set;return s.addListener("get",t=>{e.has(t)||e.add(t)}),t(),s.removeAllListeners(),[...e]},t.Value=function(e){var i=null,n=t.Watch(()=>{i=e()});if(n.length>0){var r=n[n.length-1];if(r instanceof a)return new h(r.store,r.___path)}return new u(i)}}(l=e.ObjectStore||(e.ObjectStore={}))},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(){this.callbackMap={}}addListener(t,e){var i=this.callbackMap[t]||new Set;i.has(e)||i.add(e),this.callbackMap[t]=i}removeListener(t,e){var i=this.callbackMap[t];i&&i.delete(e)}emit(t,...e){var i=this.callbackMap[t];i&&i.forEach(t=>t(...e))}clear(t){var e=this.callbackMap[t];e&&e.clear()}removeAllListeners(){for(var t in this.callbackMap)this.clear(t)}}e.Emitter=i,e.default=i},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(6),r=i(1),s=i(2);e.default=class extends n.Binding{constructor(t,e,i,n){super(t,e,{children:i,key:n})}Destroy(){super.Destroy(),this.DestroyTemplates(this.activeTemplateMap),this.activeTemplateMap=null}Init(t){this.activeTemplateMap=new Map,this.activeKeys=[],this.childrenFunction=t.children,this.keyFunction=t.key}Apply(){var t=this.Value;t?Array.isArray(t)||(t=[t]):t=[];for(var e,i=new Map,n=[],a=s.BindingConfig.createContainer(),o=null,h=0;h<t.length;h++){var u=this.keyFunction&&this.keyFunction(t[h])||h;n.push(u);var l=this.activeTemplateMap.get(u);if(!l){var c=this.childrenFunction(t[h],h);Array.isArray(c)||(c=[c]),l=c.map(t=>(e=t,new(e.class||r.Template)(e)))}i.set(u,l),this.activeTemplateMap.delete(u),h>=this.activeKeys.length?l.forEach(t=>{t.AttachToContainer(a),o=t}):u!==this.activeKeys[h]?l.forEach(t=>{t.AttachAfter(this.BoundTo,o),o=t}):o=l[l.length-1]||o}this.DestroyTemplates(this.activeTemplateMap),this.activeTemplateMap=i,this.activeKeys=n,s.BindingConfig.addChildContainer(this.BoundTo,a)}DestroyTemplates(t){t.forEach(t=>t.forEach(t=>t.Destroy()))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(6),r=i(2);e.default=class extends n.Binding{constructor(t,e){super(t,e,null)}Apply(){r.BindingConfig.setText(this.BoundTo,this.Value)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(6),r=i(2);e.default=class extends n.Binding{constructor(t,e){super(t,e,null)}Destroy(){for(var t in super.Destroy(),this.boundEvents)r.BindingConfig.removeListener(this.BoundTo,t,this.boundEvents[t])}Apply(){for(var t in this.boundEvents)r.BindingConfig.removeListener(this.BoundTo,t,this.boundEvents[t]);this.boundEvents={};var e=this.Value;for(var t in e)this.boundEvents[t]=e[t],r.BindingConfig.addListener(this.BoundTo,t,e[t])}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(1);e.a=function(t,e){return n.TemplateFunction("a",t,e)},e.br=function(t,e){return n.TemplateFunction("br",t,e)},e.b=function(t,e){return n.TemplateFunction("b",t,e)},e.div=function(t,e){return n.TemplateFunction("div",t,e)},e.span=function(t,e){return n.TemplateFunction("span",t,e)},e.img=function(t,e){return n.TemplateFunction("img",t,e)},e.video=function(t,e){return n.TemplateFunction("video",t,e)},e.source=function(t,e){return n.TemplateFunction("source",t,e)},e.input=function(t,e){return n.TemplateFunction("input",t,e)},e.option=function(t,e){return n.TemplateFunction("option",t,e)},e.select=function(t,e){return n.TemplateFunction("select",t,e)},e.h1=function(t,e){return n.TemplateFunction("h1",t,e)},e.h2=function(t,e){return n.TemplateFunction("h2",t,e)},e.h3=function(t,e){return n.TemplateFunction("h3",t,e)}}]);